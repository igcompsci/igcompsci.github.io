function e(e){let t=e,r=["forward","light","left","right","jump","p1","p2"],n=(e=e.toLowerCase()).split(/\s+/);if(1===n.length){if(!r.includes(e))throw Error(`Invalid instruction '${t}'`)}else{if(3!==n.length)throw Error(`Invalid instruction '${t}'`);if(e=n[0].toLowerCase(),strIf=n[1].toLowerCase(),brushColor=n[2].toLowerCase(),!r.includes(e))throw Error(`Invalid condition instruction '${t}'`);if("if"!==strIf)throw Error(`Invalid condition instruction '${t}'`);if(!["red","green"].includes(brushColor))throw Error(`Invalid brush color '${brushColor}' in condition instruction '${t}'`)}return e}function t(t){document.getElementById("lightbot-error-wrap").classList.add("hidden");try{!function(t){let r={blockName:null},n=[],o=["name","stage","main","proc1","proc2","__end__"],i=["name","stage"],l=["main","proc1","proc2","__end__"],a=t.split(/\r?\n/);a.push("__END__:");for(let t of a)if(t=t.trim(),""!==t)if(t.includes(":")){let e=t.split(":",2),a=e[0].trim(),d=e[0].trim().toLowerCase(),s=e[1].trim();if(!o.includes(d))throw Error(`Invalid section part '${a}'`);if(!i.includes(d)){let e=d;if(!l.includes(e))throw Error(`Invalid block part '${a}'`);null==r.blockName?r.blockName=e:(r.blockName=e,n=[]),"main"==e&&(r.mainBlock=!0)}switch(d){case"name":r.name=s;break;case"stage":r.stage=s}}else n.push(e(t));if(null==r.name)throw Error("Missing Name part");if(null==r.stage)throw Error("Missing Stage part");{let e=String(r.stage);if(!/^\d-\d$/.test(e))throw Error(`Invalid stage '${e}'`)}if(null==r.mainBlock)throw Error("Missing MAIN block");alert("Lightbot file format is OK!")}(t)}catch(e){document.getElementById("lightbot-error").innerText=e.message,document.getElementById("lightbot-error-wrap").classList.remove("hidden")}}var r;r=function(){document.getElementById("codeInput").value="Name: Larry Xu\nStage: 5-1\n\nMAIN:\n  P1\n\nPROC1:\n  forward\n  right if green\n  light\n  P1\n",document.querySelector(".do-check").addEventListener("click",(()=>{t(document.querySelector(".code-input").value)})),document.getElementById("lightbot-error-close-icon").addEventListener("click",(()=>{document.getElementById("lightbot-error").innerText="",document.getElementById("lightbot-error-wrap").classList.add("hidden")}))},"loading"!=document.readyState?r():document.addEventListener("DOMContentLoaded",r);